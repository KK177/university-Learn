[TOC]

## 轮询访问介质访问控制

- 介质访问控制协议——MAC协议

- 在三种协议中，只有随机访问介质访问控制协议是会产生冲突的

![image-20210506212146119](/Users/macbookpro/Library/Application Support/typora-user-images/image-20210506212146119.png)

### 轮询协议

- 链路上连接的主机中会默认有一台是主结点，主结点会向连接在该链路上的主机发送一个数据帧，去问它们是否需要发送信息，需要则可以发送信息，不需要，主结点就会问下面的结点
- 单点故障指的是 主结点的故障，会导致没有主机去询问子结点是否需要发送信息

![image-20210506212455300](/Users/macbookpro/Library/Application Support/typora-user-images/image-20210506212455300.png)

### 令牌传递协议

- 首先链路上的主机连接在一个环形网络上
- 令牌：一个特殊格式的MAC控制帧，不包含任何信息。令牌会一直在链路上传递，直到有主机要发送信息
- 比如主机A要发送信息，那么主机A就会持有令牌，修改令牌上控制帧的数据（将令牌由空闲的状态转为繁忙的状态）然后把要发送的数据跟令牌组合成数据帧传递出去，那么经过链路上的主机时，如果是发送给自己的就将数据帧复制一份，然后继续传递令牌，如果不是发送给自己的，那么不做处理，直接转发令牌
- 当令牌回到主机A上时，主机A会检查转发回来的数据帧是否出错，出错则重传，没出错，则修改令牌控制帧的数据（将繁忙状态改为空闲状态），然后继续将令牌传递出去

![image-20210506213239223](/Users/macbookpro/Library/Application Support/typora-user-images/image-20210506213239223.png)

![image-20210506213846460](/Users/macbookpro/Library/Application Support/typora-user-images/image-20210506213846460.png)

## CSMA/CD协议

- CS：载波监听，每一个站点在发送数据之前以及发送数据时都要检测一下总线上是否有其他计算机在发送数据
- MA：多点接入，表示许多计算机以多点接入的方式连接在一根总线上
- CD：碰撞检测，“边发送边监听”，适配器边发送数据边检测信道上信号电压的变化情况，以便判断自己在发送数据时其他站是否也在发送数据

![image-20210508202353822](计网第三章后.assets/image-20210508202353822.png)

### 传播时延对载波监听的影响

由于存在传播时延，站点A已经在信道上发送数据时，但是还没到达站点B的监听范围，站点B就会误以为这条信道是空闲的，那么这时候站点B发送数据，就会产生冲突

![image-20210508203848387](计网第三章后.assets/image-20210508203848387.png)

- 最迟经过2乇才能知道自己发送的数据没和别人碰撞

![image-20210508204638904](计网第三章后.assets/image-20210508204638904.png)

### 确定碰撞之后的重传时机

如果知道自己发送的信息发生了碰撞，就立马重传的话是不行的，这样会导致恶性循环

![image-20210508204910079](计网第三章后.assets/image-20210508204910079.png)

那么在CSMA/CD协议中，我们是使用截断二进制指数规避算法来确定碰撞后的重传时机的

![image-20210508205729756](计网第三章后.assets/image-20210508205729756.png)

### 最小帧长问题

为了能够发挥CSMA/CD协议的最大优势，我们会定义出一个最小帧长，避免出现在检测到碰撞之间就已经把所有数据都发送出去了

![image-20210508205930987](计网第三章后.assets/image-20210508205930987.png)

![image-20210508210252196](计网第三章后.assets/image-20210508210252196.png)

![image-20210628161401410](计网第三章后.assets/image-20210628161401410.png)



### 总结🌟

![image-20210508210634220](计网第三章后.assets/image-20210508210634220.png)

## CSMA/CA协议

与CSMA/CD协议的不同的：CD是碰撞检测，CA是碰撞避免。CD协议主要是应用于总线型以太网（有线型网络），CA协议主要是应用于无线型网络

![image-20210508211408280](计网第三章后.assets/image-20210508211408280.png)

### CSMA/CA协议工作原理

RTS和CTS能够有效解决隐蔽站的问题，比如A站点和C站点想要同时给B站点发送信息，那么当A站点向B站点发送了一个RTS之后，B站点回复了A站点一个CTS，那么当B站点收到C站点的RTS时，B站点不回复，那么C站点就会知道现在已经有人在跟B通信了

![image-20210508212122192](计网第三章后.assets/image-20210508212122192.png)

### CSMA/CD与CSMA/CA协议

![image-20210508212643072](计网第三章后.assets/image-20210508212643072.png)

## 局域网基本概念和体系结构

### 局域网

局域网内是使用广播信道的

![image-20210509112214161](计网第三章后.assets/image-20210509112214161.png)

### 局域网拓扑结构

总线型拓扑是优势最明显的

![image-20210509124024023](计网第三章后.assets/image-20210509124024023.png)

### 局域网传输介质

![image-20210509124211572](计网第三章后.assets/image-20210509124211572.png)

### 局域网介质访问控制方法

![image-20210509124434820](计网第三章后.assets/image-20210509124434820.png)

### 局域网的分类

FDDI网的传输介质是光纤

![image-20210509124802904](计网第三章后.assets/image-20210509124802904.png)

### IEEE 802现有标准

![image-20210509125131786](计网第三章后.assets/image-20210509125131786.png)

### MAC子层和LLC子层

![image-20210509125323697](计网第三章后.assets/image-20210509125323697.png)

### 总结🌟

![image-20210509130131032](计网第三章后.assets/image-20210509130131032.png)

## 以太网

### 以太网的概述

![image-20210509130515953](计网第三章后.assets/image-20210509130515953.png)

### 以太网提供无连接，不可靠的服务

差错控制交由传输层去实现

![image-20210509130940844](计网第三章后.assets/image-20210509130940844.png)

### 以太网传输介质和拓扑结构的发展

- 物理拓扑 研究的是怎么将设备连接起来
- 逻辑拓扑 研究的是设备之间的通信

![image-20210509131618087](计网第三章后.assets/image-20210509131618087.png)

### 10BASE-T以太网

![image-20210509132003744](计网第三章后.assets/image-20210509132003744.png)

### 适配器和MAC地址

现在的适配器是已经嵌入在计算机的网卡里面的

每个适配器都有全球唯一的一个的MAC地址

![image-20210509132332952](计网第三章后.assets/image-20210509132332952.png)

### 以太网MAC帧

在MAC层里，类型是指明网络层的协议，以便接收方接收到数据帧时对数据进行解析，然后上交到网络层

MAC层的数据的最小字节是46，这是根据CSMA/CD协议的最小帧长64计算出来的

FCS是循环冗余码里面的帧检验系列

在物理层会对以太网MAC帧插入前导码，物理层使用的是曼彻斯特编码，前导码中11就代表数据帧的开始，当检测不到电压的变化时就代表数据帧的结束

![image-20210509133445681](计网第三章后.assets/image-20210509133445681.png)

### 高速以太网

![image-20210509134131222](计网第三章后.assets/image-20210509134131222.png)

### 总结🌟

![image-20210509134528534](计网第三章后.assets/image-20210509134528534.png)

## 无线局域网

无线局域网跟wifi是不一样的，无线局域网比wifi覆盖的范围更加地大

接收端和发送端其实是两个基站的MAC地址

![image-20210510100403304](计网第三章后.assets/image-20210510100403304.png)

### 802.11的MAC帧头格式

![image-20210510100642987](计网第三章后.assets/image-20210510100642987.png)

### 无线局域网的分类

![image-20210510100720538](计网第三章后.assets/image-20210510100720538.png)

### 有固定基础设施无线局域网

一个wifi其实就是对应一个基本服务集，而不同的服务集之间的通信要借助分配系统DS（其实是有线跟无线的集合）

![image-20210510101023157](计网第三章后.assets/image-20210510101023157.png)

### 无固定基础设施无线局域网的自组织网络

这个网络下是没有基站，转发器的。该网络下的每一台主机都可以接收信息，发送信息以及转发信息

![image-20210510101254495](计网第三章后.assets/image-20210510101254495.png)

## PPP协议&HDLC协议

### 广域网

现在的Internet就是一个广域网的例子

广域网与局域网的区别：广域网覆盖的范围更大，覆盖的网络体系结构更多，覆盖了物理层，数据链路层以及网络层，而局域网只覆盖了物理层和数据链路层。广域网一般都是点对点接入，而局域网则主要是多点接入。广域网由于范围的大，信息传输的延迟率高，因此，广域网主要是侧重在资源共享，而局域网主要侧重在信息传输

广域网中常用的链路层协议是PPP协议以及HDLC协议

![image-20210510102404633](计网第三章后.assets/image-20210510102404633.png)

### PPP协议的特点

![image-20210510103000712](计网第三章后.assets/image-20210510103000712.png)

### PPP协议应满足的需求

在链路层无需实现可靠传输，可靠传输已经交付给传输层去实现了

![image-20210510103458986](计网第三章后.assets/image-20210510103458986.png)

### PPP协议无需满足的要求

纠错，流量控制以及序号已经交付给传输层去实现了

只需要支持点对点线路即🉑️

![image-20210510103638555](计网第三章后.assets/image-20210510103638555.png)

### PPP协议的三个组成部分

#### 同步线路与异步线路

- 同步线路：传输数据是以字节为单位的
- 异步线路：传输数据是以字符为单位的

LCP相当于物理上的连接，而NCP相当于逻辑上的连接，当两者都实现之后，才可以实现真正的上网

![image-20210510104013635](计网第三章后.assets/image-20210510104013635.png)

### PPP协议的状态图

![image-20210510104221255](计网第三章后.assets/image-20210510104221255.png)

### PPP协议的帧格式

![image-20210510104555192](计网第三章后.assets/image-20210510104555192.png)

### HDLC协议

HDLC协议也是应用在广域网中的点对点协议，但是应用较少

PPP协议是面向字节的协议，HDLC是面向比特的协议

![image-20210510104909515](计网第三章后.assets/image-20210510104909515.png)

### HDLC的站

异步响应方式：就是从站不需要经过主站的同意就可以发送信息

异步平衡方式：每个站都是平等的地位，都可以接收信息和发送信息，不受约束

![image-20210510105051274](计网第三章后.assets/image-20210510105051274.png)

### HDLC的帧格式

HDLC有三种帧：信息帧，监督帧和无编号帧

![image-20210510105426853](计网第三章后.assets/image-20210510105426853.png)

### PPP协议&HDLC协议

透明传输：PPP协议通过零比特插入法和字符填充实现，HDLC协议只能通过零比特插入法实现

HDLC协议尽管实现的是可靠传输，但是可靠传输已经交付给传输层了，再在链路层实现就会大大增加时间上的开销

![image-20210510105715671](计网第三章后.assets/image-20210510105715671.png)

### 总结🌟

![image-20210510110127652](计网第三章后.assets/image-20210510110127652.png)

## 链路层设备

### 物理层扩展以太网

第一种：利用光纤调制器和光纤解调器

在主机和集线器之间连接的线路中连接光纤调制器和光纤解调器，光纤调制器可以把传播的电信号转换为光信号，然后光信号在光纤上传播，到光纤解调器处再把光信号转换为电信号

第二种：利用集线器

利用一个大的主干集线器将不同区域的集线器连接起来，这样做的好处是：通信的范围变大了，但是冲突域也变大了，同一时间内只有一台主机可以发送信息，这样在大的冲突域范围下更容易发生冲突了。

![image-20210511150412597](计网第三章后.assets/image-20210511150412597.png)

![image-20210511150101969](计网第三章后.assets/image-20210511150101969.png)

### 链路层扩展以太网

利用到的设备有网桥和交换机——网桥是交换机的前身，现在主要用到的是交换机

网桥收到一个帧之后，并不会像集线器一样向所有接口转发此帧，而是先检查此帧的目的MAC地址，然后再确定将此帧转发到哪一接口，或者是把它丢弃

集线器下整个大的冲突域同一时间内只能有一台主机可以发送信息，但是在网桥下，每个冲突域内部的通信是互不干扰的，比如：同一时间下，主机A可以向主机B发信息，主机C也可以向主机D发信息，那么这样子就可以大大增加网络的吞吐量，比如一个冲突域的带宽为10兆b/s，那么网桥下整个以太网的带宽为30兆b/s，如果是集线器，那么还是10兆b/s

网段：一般指一个计算机网络中使用同一物理层设备（传输介质，中继器，集线器等）能够直接通讯的那一部分

![image-20210511151140121](计网第三章后.assets/image-20210511151140121.png)

### 网桥分类——透明网桥

透明网桥：“透明”指以太网上的站点并不知道所发送的帧将经过哪几个网桥，是一种即插即用设备（通过自学习算法来完善自身的转发表）

网桥：每个网桥都有自己的转发表，通过转发表，网桥可以根据目的MAC地址转发数据帧，但是网桥刚插进以太网时只有一张空的转发表，那么就需要通过自学习来完善这张转发表，当经过一定时间后，转发表就会自动清空表中数据，然后重新自学习，因此，转发表中的信息一般都是最新的网络数据传输情况。

转发表的构造过程：举个🌰：比如A要发信息给B，那么从主机A发送的帧经过广播信道之后传播出去，主机B收到主机A发来的信息后会自行进行处理，但是主机A发出的帧不止发送到B上，还去到了网桥，那么这时候网桥从接口1收到了来自主机A发出的帧，那么网桥就会在自己的转发表里加上地址A，接口1这条信息，网桥还会在转发表里搜索看有没有地址B的信息，如果有的话，会直接根据接口转发信息，如果没有，那么也会往自身的所有接口转发出去。

![image-20210511152444452](计网第三章后.assets/image-20210511152444452.png)

### 网桥分类-源路由网桥

源路由网桥：在发送帧时，把详细的最佳路由信息（路由最好/时间最短）放在帧的首部中

工作流程：源站在发送帧之前会以广播方式向欲通信目的站发送一个**发现帧**，当目的站收到发现帧之后，也会发送一个响应帧并且这个响应帧是会沿着原路径返回，那么源站就会收到多个响应帧，在多个响应帧中，源站就会选择经过路由最少或者时间最短的路径信息放在**待发送**的帧的首部，然后再把要发送的帧发送出去。

![image-20210511153501122](计网第三章后.assets/image-20210511153501122.png)

### 多接口网桥——以太网交换机

网桥：网桥上的接口只有两个

交换机：交换机上有十几个端口，是网桥的进一步扩展  

![image-20210511154259471](计网第三章后.assets/image-20210511154259471.png)

### 以太网交换机的两种交换方式

直通式交换机：可靠性低，不会对帧进行差错检测

现在使用的一般都是存储转发式交换机

![image-20210511154516505](计网第三章后.assets/image-20210511154516505.png)

### 冲突域和广播域

![image-20210511154816520](计网第三章后.assets/image-20210511154816520.png)

一般按照路由器的接口来划分广播域，按照交换机的接口来划分冲突域

![image-20210511154938235](计网第三章后.assets/image-20210511154938235.png)

### 总结

![image-20210511155327640](计网第三章后.assets/image-20210511155327640.png)

### 链路层总结🌟

![image-20210511160525187](计网第三章后.assets/image-20210511160525187.png)